---
Test
---
!*> Setup
!path target/cws-fitnesse.jar
!define TEST_SYSTEM {slim}

|Import                 |
|io.javadog.cws.fitnesse|
*!

!2 '''!-CryptoStore-! Settings Request'''
The !-CryptoStore-! Settings request can only be performed by the System Administrator, i.e. the system super user. It is a way to both extract the current settings, and update existing values.

!|script|Settings     |admin                          |admin                                                     |
|check  |value for key|cws.crypto.symmetric.algorithm |AES128                                                    |
|check  |value for key|cws.crypto.asymmetric.algorithm|RSA2048                                                   |
|check  |value for key|cws.crypto.signature.algorithm |SHA512                                                    |
|check  |value for key|cws.crypto.pbe.algorithm       |PBE128                                                    |
|check  |value for key|cws.crypto.hash.algorithm      |SHA512                                                    |
|check  |value for key|cws.system.salt                |Default salt, also used as kill switch. Must be set in DB.|
|check  |value for key|cws.system.locale              |EN                                                        |
|check  |value for key|cws.system.charset             |UTF-8                                                     |
|check  |value for key|cws.expose.admin               |false                                                     |
|check  |value for key|cws.show.all.circles           |true                                                      |
|check  |value for key|cws.show.trustees              |true                                                      |
|check  |value for key|cws.sanity.check.startup       |true                                                      |
|check  |value for key|cws.sanity.check.interval.days |180                                                       |

!|script|Settings     |member1                        |member1  |
|check  |value for key|cws.crypto.symmetric.algorithm |undefined|
|check  |value for key|cws.crypto.asymmetric.algorithm|undefined|
|check  |value for key|cws.crypto.signature.algorithm |undefined|
|check  |value for key|cws.crypto.pbe.algorithm       |undefined|
|check  |value for key|cws.crypto.hash.algorithm      |undefined|
|check  |value for key|cws.system.salt                |undefined|
|check  |value for key|cws.system.locale              |undefined|
|check  |value for key|cws.system.charset             |undefined|
|check  |value for key|cws.expose.admin               |undefined|
|check  |value for key|cws.show.all.circles           |undefined|
|check  |value for key|cws.show.trustees              |undefined|
|check  |value for key|cws.sanity.check.startup       |undefined|
|check  |value for key|cws.sanity.check.interval.days |undefined|

!|Settings                                                                                                                                    |
|account name|credential|key                     |value |return code?   |return message?                                             |defined?|
|admin       |admin     |cws.crypto.pbe.algorithm|PBE512|SETTING_WARNING|Unsupported Crypto Algorithm for 'cws.crypto.pbe.algorithm'.|        |
|admin       |admin     |cws.crypto.pbe.algorithm|PBE256|SUCCESS        |Ok                                                          |PBE256  |
|admin       |admin     |cws.crypto.pbe.algorithm|PBE128|SUCCESS        |Ok                                                          |PBE128  |
