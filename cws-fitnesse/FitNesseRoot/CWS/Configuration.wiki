---
Test
---
!*> Setup
!path target/cws-fitnesse.jar
!define TEST_SYSTEM {slim}

# Return Codes
!define SUCCESS {200}
!define AUTHENTICATION_WARNING {403}
!define SETTING_WARNING {492}

|Import                 |
|io.javadog.cws.fitnesse|
*!

!*>  Clean Database
!|script|clean database|
|remove circles        |
|remove members        |

*!

!2 '''!-CWS-! Version Request'''
The !-CWS-! Version request is not requiring any credentials, or - well, anything.
It is a simple static ''is alive'' request.

!|Version                                 |
|return code?|return message?|cws version?|
|${SUCCESS}  |Ok             |1.1-SNAPSHOT|

!2 '''!-CWS-! Settings Request'''
The !-CWS-! Settings request can only be performed by the System
Administrator, i.e. the system super user. It is a way to both extract the
current settings, and update existing values.

'''Important'''; ''The very first request made with the '''admin''' account will
also set the password for the administrator. By default, the passphrase is empty
or undefined. Which means that it can be set to anything the administrator
prefers, thus preventing that someone forgets to change the default. It is
recommended that common best practices regarding the pick of the passphrase is
followed - for the sake of this test, it is set to 'admin'.''

!|script|Settings     |admin                          |admin                                                     |
|check  |value for key|cws.crypto.symmetric.algorithm |AES_CBC_256                                               |
|check  |value for key|cws.crypto.asymmetric.algorithm|RSA_2048                                                  |
|check  |value for key|cws.crypto.signature.algorithm |SHA_512                                                   |
|check  |value for key|cws.crypto.pbe.algorithm       |PBE_256                                                   |
|check  |value for key|cws.crypto.hash.algorithm      |SHA_512                                                   |
|check  |value for key|cws.system.salt                |Default salt, also used as kill switch. Must be set in DB.|
|check  |value for key|cws.system.locale              |EN                                                        |
|check  |value for key|cws.system.charset             |UTF-8                                                     |
|check  |value for key|cws.expose.admin               |false                                                     |
|check  |value for key|cws.show.all.circles           |true                                                      |
|check  |value for key|cws.show.trustees              |true                                                      |
|check  |value for key|cws.sanity.check.startup       |true                                                      |
|check  |value for key|cws.sanity.check.interval.days |180                                                       |

Note, that if a different user attempts to invoke this request, it will result
in a list of undefined values.

!|script|Settings     |member1                        |member1  |
|check  |value for key|cws.crypto.symmetric.algorithm |undefined|
|check  |value for key|cws.crypto.asymmetric.algorithm|undefined|
|check  |value for key|cws.crypto.signature.algorithm |undefined|
|check  |value for key|cws.crypto.pbe.algorithm       |undefined|
|check  |value for key|cws.crypto.hash.algorithm      |undefined|
|check  |value for key|cws.system.salt                |undefined|
|check  |value for key|cws.system.locale              |undefined|
|check  |value for key|cws.system.charset             |undefined|
|check  |value for key|cws.expose.admin               |undefined|
|check  |value for key|cws.show.all.circles           |undefined|
|check  |value for key|cws.show.trustees              |undefined|
|check  |value for key|cws.sanity.check.startup       |undefined|
|check  |value for key|cws.sanity.check.interval.days |undefined|

----------
!3 Symmetric Algorithm
The primary part of all internal encryption is performed using Symmetric Keys. These are all based on the AES algorithms and only the
size of the keys may be changed. The default value is '''AES256''', but if an earlier version of Java 8 is used, or if there is various
problems with allowing this Key size, then it can be set to a lower value.
The allowed values are:
 * '''AES_CBC_128'''
 * '''AES_CBC_192'''
 * '''AES_CBC_256'''
 * '''AES_GCM_128'''

Pending Algorithms:
 * '''AES_GCM_192'''
 * '''AES_GCM_256'''

!|Settings                                                                                                                                                           |
|account name|credential|key                           |value      |return code?      |return message?                                                   |defined?   |
|admin       |admin     |cws.crypto.symmetric.algorithm|AES_GCM_128|${SUCCESS}        |Ok                                                                |AES_GCM_128|
|admin       |admin     |cws.crypto.symmetric.algorithm|AES_CBC_128|${SUCCESS}        |Ok                                                                |AES_CBC_128|
|admin       |admin     |cws.crypto.symmetric.algorithm|AES_CBC_192|${SUCCESS}        |Ok                                                                |AES_CBC_192|
|admin       |admin     |cws.crypto.symmetric.algorithm|AES_CBC_256|${SUCCESS}        |Ok                                                                |AES_CBC_256|
|admin       |admin     |cws.crypto.symmetric.algorithm|AES_CBC_512|${SETTING_WARNING}|Unsupported Crypto Algorithm for 'cws.crypto.symmetric.algorithm'.|AES_CBC_256|

----------
!3 Asymmetric Algorithm
Each Member Account will have a Asymmetric Key generated by default, this is used to encrypt and decrypt the Symmetric Keys, as well as Signing and Verifying signatures.
Higher Key size will give higher security. However, Asymmetric encryption/decryption is very costly compared to Symmetric cryptography. Hence, the use of these Keys is
minimized. The default value is '''RSA2048''', increasing this to a higher Key size, will have a drastic performance cost, and should only be done if a higher level of
security is needed or if enough CWS instances with enough resources is being used, so the cost can be mitigated.
The allowed values are:
 * '''RSA_2048'''
 * '''RSA_4096'''
 * '''RSA_8192'''

!|Settings                                                                                                                                                       |
|account name|credential|key                            |value   |return code?      |return message?                                                    |defined?|
|admin       |admin     |cws.crypto.asymmetric.algorithm|RSA_8192|${SUCCESS}        |Ok                                                                 |RSA_8192|
|admin       |admin     |cws.crypto.asymmetric.algorithm|RSA_4096|${SUCCESS}        |Ok                                                                 |RSA_4096|
|admin       |admin     |cws.crypto.asymmetric.algorithm|RSA_2048|${SUCCESS}        |Ok                                                                 |RSA_2048|
|admin       |admin     |cws.crypto.asymmetric.algorithm|RSA_1024|${SETTING_WARNING}|Unsupported Crypto Algorithm for 'cws.crypto.asymmetric.algorithm'.|RSA_2048|

----------
!3 PBE Algorithm
The PBE, Password Based Encryption, Algorithm, which is the Algorithm used to convert a given Passphrase to a Symmetric Key,
is based on the PBKDF2 algorithm, which again is a special way to generated a Symmetric Key, just as normal Symmetric Keys.
The allowed values are:
 * '''PBE_128'''
 * '''PBE_192'''
 * '''PBE_256'''

!|Settings                                                                                                                                        |
|account name|credential|key                     |value  |return code?      |return message?                                             |defined?|
|admin       |admin     |cws.crypto.pbe.algorithm|PBE_128|${SUCCESS}        |Ok                                                          |PBE_128 |
|admin       |admin     |cws.crypto.pbe.algorithm|PBE_192|${SUCCESS}        |Ok                                                          |PBE_192 |
|admin       |admin     |cws.crypto.pbe.algorithm|PBE_256|${SUCCESS}        |Ok                                                          |PBE_256 |
|admin       |admin     |cws.crypto.pbe.algorithm|PBE_512|${SETTING_WARNING}|Unsupported Crypto Algorithm for 'cws.crypto.pbe.algorithm'.|PBE_256 |

